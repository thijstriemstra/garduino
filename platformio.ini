; PlatformIO Project Configuration File

[platformio]
description = Greenhouse monitoring using ESP32
extra_configs =
  secrets.ini

[common]
config_flags =
  ; -------------------------------------
  ; SCHEDULE
  ; -------------------------------------
  ; How often (in sec) the device should wake up
  ; Recommended value: 240 sec
  -D WakeupSchedule=240
  ; How often (in sec) the device should publish sensor data while it's
  ; powered on (e.g. during watering or manual mode)
  ; Recommended value: > 30 sec
  -D SensorPublishSchedule=35
  ; How long to water daily (in sec)
  ; Recommended value: 120 sec
  -D WateringDuration=180
  ; Time to water daily
  -D 'WateringSchedule="19:00"'
  ; -------------------------------------
  ; I2C:
  ;  - DS3231 RTC (0x68)
  ;  - AT24C32 EEPROM on DS3231 (0x57)
  ;  - TCA9548A I2C expander (0x70)
  ;
  ; I2C expander:
  ;  - SSD1306 OLED (0x3C)
  ;  - BME280 barometer (0x76)
  ;  - BH1750 light sensor (0x23)
  ; -------------------------------------
  -D ExpanderAddress=0x70
  -D ExpanderSCLPin=22
  -D ExpanderSDAPin=4
  ; DS3231 Realtime Clock
  -D ClockSDAPin=16
  -D ClockSCLPin=17
  ; BH1750 Light sensor
  -D LightSensorAddress=0x23
  -D LightSensorChannel=0
  ; BME280 Climate Sensor
  -D BarometerChannel=1
  ; SSD1306 OLED display
  -D DisplayAddress=0x3C
  -D DisplayChannel=2
  ; -------------------------------------
  ; SPI:
  ;  - MCP3008 analog expander
  ;
  ; Analog expander:
  ;  - Capacitive Soil Sensor x 5
  ;  - Rain sensor
  ; -------------------------------------
  -D AnalogExpanderCSPin=5
  ; Soil
  -D SoilSensor1Channel=0
  -D SoilSensor1Wet=948
  -D SoilSensor1Dry=2731
  -D SoilSensor2Channel=1
  -D SoilSensor2Wet=927
  -D SoilSensor2Dry=2731
  -D SoilSensor3Channel=2
  -D SoilSensor3Wet=912
  -D SoilSensor3Dry=2743
  -D SoilSensor4Channel=3
  -D SoilSensor4Wet=945
  -D SoilSensor4Dry=2751
  -D SoilSensor5Channel=4
  -D SoilSensor5Wet=956
  -D SoilSensor5Dry=2791
  ; Rain
  -D RainSensorChannel=5
  ; Watering indication LED
  -D WateringIndicationLEDPin=25
  ; Temperature
  -D TemperatureSensorsPin=13
  ; Water Valve
  -D WaterValvePin=2
  ; Water Flow Meter
  -D WaterFlowMeterPin=15
  ; Manual Run
  -D ManualRunButtonPin=36
  -D ManualRunLEDPin=26
  ; Power (deepsleep)
  -D PowerButtonPin=39
  -D PowerLEDPin=27
  ; Network LED
  -D NetworkLEDPin=33
network_flags =
  ; -------------------------------------
  ; NETWORK
  ; -------------------------------------
  ; NTP Time Synchronization host address
  -D 'NTP_HOST="192.168.2.1"'
  ; MQTT
  -D 'MQTT_BASE_TOPIC="foo/bar"'
  ; MQTT broker host
  -D 'MQTT_HOST="192.168.2.1"'
  ; MQTT broker port
  -D MQTT_PORT=1883
  ; MQTT broker username
  -D 'MQTT_USER="username"'
  ; MQTT broker password
  -D 'MQTT_PASSWORD="password"'
  ; MQTT client keep alive (in sec)
  -D MQTT_TIMEOUT=15
  ; WIFI
  -D 'WIFI_SSID="ssid"'
  -D 'WIFI_PASSWORD="password"'

[env:garduino]
platform = espressif32
board = lolin32_lite
framework = arduino
monitor_speed = 115200
;monitor_port = /dev/tty.wchusbserial1410
;upload_port = /dev/tty.wchusbserial1410

lib_deps =
  Functor
  wifwaf/TCA9548A
  sekdiy/FlowMeter
  thijse/ArduinoLog
  wollewald/BH1750_WE
  adafruit/RTClib
  adafruit/Adafruit MCP3008
  adafruit/Adafruit BME280 Library
  milesburton/DallasTemperature
  thingpulse/ESP8266 and ESP32 OLED driver for SSD1306 displays
  ; use latest, see https://github.com/marvinroger/async-mqtt-client/issues/185
  https://github.com/marvinroger/async-mqtt-client/archive/refs/heads/develop.zip

lib_extra_dirs =
  ~/projects/arduino-lib

build_flags = ${common.config_flags} ${common.network_flags}
